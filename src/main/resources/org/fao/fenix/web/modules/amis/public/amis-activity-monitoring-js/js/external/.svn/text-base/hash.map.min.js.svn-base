function Map(a){this.current=void 0;this.size=0;!1===a&&this.disableLinking()}Map.noop=function(){return this};Map.illegal=function(){throw Error("illegal operation for maps without linking");};Map.from=function(a,b){var d=new Map,c;for(c in a)(b||a.hasOwnProperty(c))&&d.put(c,a[c]);return d};Map.prototype.disableLinking=function(){this.disableLinking=this.unlink=this.link=Map.noop;this.removeAll=this.value=this.key=this.next=Map.illegal;return this};
Map.prototype.hash=function(a){return typeof a+" "+(a instanceof Object?a.__hash||(a.__hash=++arguments.callee.current):a.toString())};Map.prototype.hash.current=0;Map.prototype.get=function(a){a=this[this.hash(a)];return void 0===a?void 0:a.value};Map.prototype.put=function(a,b){var d=this.hash(a);if(void 0===this[d]){var c={key:a,value:b};this[d]=c;this.link(c);++this.size}else this[d].value=b;return this};
Map.prototype.remove=function(a){a=this.hash(a);var b=this[a];void 0!==b&&(--this.size,this.unlink(b),delete this[a]);return this};Map.prototype.removeAll=function(){for(;this.size;)this.remove(this.key());return this};Map.prototype.link=function(a){0==this.size?(a.prev=a,this.current=a.next=a):(a.prev=this.current.prev,a.prev.next=a,a.next=this.current,this.current.prev=a)};
Map.prototype.unlink=function(a){0==this.size?this.current=void 0:(a.prev.next=a.next,a.next.prev=a.prev,a===this.current&&(this.current=a.next))};Map.prototype.next=function(){this.current=this.current.next};Map.prototype.key=function(){return this.current.key};Map.prototype.value=function(){return this.current.value};